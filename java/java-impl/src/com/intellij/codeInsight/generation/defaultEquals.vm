#parse("com/intellij/codeInsight/generation/commonEqualsMacros.vm")
public boolean equals(##
#if ($settings.generateFinalParameters)
  final ##
#end
Object $paramName){
#addEqualsPrologue()
#if ($members.size() > 0)

  #addClassInstance()

  #foreach($field in $members)
    #if ($field.array)
      #addArrayEquals($field)
    #elseif ($field.primitive)
      #if ($field.double || $field.float)
        #addDoubleFieldComparison($field)
      #else 
        #addPrimitiveFieldComparison($field)
      #end
    #elseif ($field.enum)
      #addPrimitiveFieldComparison($field)
    #else
      #addFieldComparison($field)
    #end
  #end
#end

  return true;
}
##
#macro(addPrimitiveFieldComparison $field)
 if($field.name != ${classInstanceName}.$field.name) return false;
#end
##
#macro(addDoubleFieldComparison $field)
  #if ($field.double)
    if(Double.compare(${classInstanceName}.$field.name, $field.name) != 0)return false;
  #else
    if(Float.compare(${classInstanceName}.$field.name, $field.name) != 0)return false;
  #end
#end
##
#macro(addFieldComparison $field)
  #if ($field.notNull)
    if(!${field.name}.equals(${classInstanceName}.$field.name))return false;
  #else
    if($field.name != null ? !${field.name}.equals(${classInstanceName}.$field.name) : ${classInstanceName}.$field.name != null)return false;
  #end
#end
##
#macro(addArrayEquals $field) 
  #if ($field.nestedArray)
    #if ($java_version > 4)
      if(!java.util.Arrays.deepEquals($field.name, ${classInstanceName}.$field.name)) return false;
    #else
      // Compare nested arrays - values of $field.name here
    #end
    #break;
  #end
  #if ($field.objectArray)
    // Probably incorrect - comparing Object[] arrays with Arrays.equals
  #end
  if(!java.util.Arrays.equals($field.name, ${classInstanceName}.$field.name)) return false;
#end
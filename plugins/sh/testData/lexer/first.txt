shebang ('#!/bin/bash\n')
\n ('\n')
Comment ('# Simple line count example, using bash')
\n ('\n')
Comment ('#')
\n ('\n')
Comment ('# Bash tutorial: http://linuxconfig.org/Bash_scripting_Tutorial#8-2-read-file-into-bash-array')
\n ('\n')
Comment ('# My scripting link: http://www.macs.hw.ac.uk/~hwloidl/docs/index.html#scripting')
\n ('\n')
Comment ('#')
\n ('\n')
Comment ('# Usage: ./line_count.sh file')
\n ('\n')
Comment ('# -----------------------------------------------------------------------------')
\n ('\n')
\n ('\n')
Comment ('# Link filedescriptor 10 with stdin')
\n ('\n')
word ('exec')
WHITE_SPACE (' ')
int ('10')
< ('<')
file descriptor ('&0')
\n ('\n')
Comment ('# stdin replaced with a file supplied as a first argument')
\n ('\n')
word ('exec')
WHITE_SPACE (' ')
< ('<')
WHITE_SPACE (' ')
var ('$1')
\n ('\n')
Comment ('# remember the name of the input file')
\n ('\n')
assignment_word ('in')
= ('=')
var ('$1')
\n ('\n')
\n ('\n')
Comment ('# init')
\n ('\n')
assignment_word ('file')
= ('=')
string_begin ('"')
string_content ('current_line.txt')
string_end ('"')
\n ('\n')
let ('let')
WHITE_SPACE (' ')
assignment_word ('count')
= ('=')
int ('0')
\n ('\n')
\n ('\n')
Comment ('# this while loop iterates over all lines of the file')
\n ('\n')
while ('while')
WHITE_SPACE (' ')
word ('read')
WHITE_SPACE (' ')
word ('LINE')
\n ('\n')
do ('do')
\n ('\n')
WHITE_SPACE (' ')
WHITE_SPACE (' ')
WHITE_SPACE (' ')
WHITE_SPACE (' ')
Comment ('# increase line counter')
\n ('\n')
WHITE_SPACE (' ')
WHITE_SPACE (' ')
WHITE_SPACE (' ')
WHITE_SPACE (' ')
(( ('((')
word ('count')
++ ('++')
)) ('))')
\n ('\n')
WHITE_SPACE (' ')
WHITE_SPACE (' ')
WHITE_SPACE (' ')
WHITE_SPACE (' ')
Comment ('# write current line to a tmp file with name $file (not needed for counting)')
\n ('\n')
WHITE_SPACE (' ')
WHITE_SPACE (' ')
WHITE_SPACE (' ')
WHITE_SPACE (' ')
word ('echo')
WHITE_SPACE (' ')
var ('$LINE')
WHITE_SPACE (' ')
> ('>')
WHITE_SPACE (' ')
var ('$file')
\n ('\n')
WHITE_SPACE (' ')
WHITE_SPACE (' ')
WHITE_SPACE (' ')
WHITE_SPACE (' ')
Comment ('# this checks the return code of echo (not needed for writing; just for demo)')
\n ('\n')
WHITE_SPACE (' ')
WHITE_SPACE (' ')
WHITE_SPACE (' ')
WHITE_SPACE (' ')
if ('if')
WHITE_SPACE (' ')
EXPR_CONDITIONAL_LEFT ('[ ')
var ('$?')
WHITE_SPACE (' ')
cond_op ('-ne')
WHITE_SPACE (' ')
word ('0')
EXPR_CONDITIONAL_RIGHT (' ]')
\n ('\n')
WHITE_SPACE (' ')
WHITE_SPACE (' ')
WHITE_SPACE (' ')
WHITE_SPACE (' ')
WHITE_SPACE (' ')
then ('then')
WHITE_SPACE (' ')
word ('echo')
WHITE_SPACE (' ')
string_begin ('"')
string_content ('Error in writing to file ')
$ ('$')
{ ('{')
word ('file')
} ('}')
string_content ('; check its permissions!')
string_end ('"')
\n ('\n')
WHITE_SPACE (' ')
WHITE_SPACE (' ')
WHITE_SPACE (' ')
WHITE_SPACE (' ')
fi ('fi')
\n ('\n')
done ('done')
\n ('\n')
\n ('\n')
word ('echo')
WHITE_SPACE (' ')
string_begin ('"')
string_content ('Number of lines: ')
var ('$count')
string_end ('"')
\n ('\n')
word ('echo')
WHITE_SPACE (' ')
string_begin ('"')
string_content ('The last line of the file is: ')
` ('`')
word ('cat')
WHITE_SPACE (' ')
$ ('$')
{ ('{')
word ('file')
} ('}')
` ('`')
string_end ('"')
\n ('\n')
\n ('\n')
Comment ('# Note: You can achieve the same by just using the tool wc like this')
\n ('\n')
word ('echo')
WHITE_SPACE (' ')
string_begin ('"')
string_content ('Expected number of lines: ')
` ('`')
word ('wc')
WHITE_SPACE (' ')
word ('-l')
WHITE_SPACE (' ')
var ('$in')
` ('`')
string_end ('"')
\n ('\n')
\n ('\n')
Comment ('# restore stdin from filedescriptor 10')
\n ('\n')
Comment ('# and close filedescriptor 10')
\n ('\n')
word ('exec')
WHITE_SPACE (' ')
int ('0')
< ('<')
file descriptor ('&10')
WHITE_SPACE (' ')
int ('10')
< ('<')
file descriptor ('&-')
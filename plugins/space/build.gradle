buildscript {
    repositories {
        maven { url 'http://dl.bintray.com/jetbrains/intellij-plugin-service' }
    }
}

plugins {
    id "org.jetbrains.intellij" version "0.2.11"
}

applyKotlinJVM()

// temparary hack to prevent slf4j version conflict. To be fixed as soon as Zolotov is back from vacation.
gradle.taskGraph.whenReady { taskGraph ->
    project.tasks.prepareSandbox.doLast {
        def pluginName = project.intellij.pluginName
        def toDelete = "$project.rootDir/app-idea/build/idea-sandbox/plugins/$pluginName/lib/slf4j-api-1.7.21.jar"
        delete toDelete
        println("delete: $toDelete")
    }
}

dependencies {
    compile project(':runtime')
    compile project(':runtime:runtime-jvm')
    compile project(':client')
    compile project(':client:client-jvm')
    compile project(':client-api')

    compile "org.jetbrains.ktor:ktor-core:$ktorVersion"
    compile "org.jetbrains.ktor:ktor-jetty:$ktorVersion"
    compile 'org.slf4j:jul-to-slf4j:1.7.12'
    compile 'ch.qos.logback:logback-classic:1.2.1'

    compile 'org.glassfish.jersey.core:jersey-common:2.23'
    compile 'org.glassfish.jersey.core:jersey-client:2.23'

    compile 'nl.komponents.kovenant:kovenant:3.3.0'
    compile 'org.apache.commons:commons-io:1.3.2'
}

intellij {
    version 'IC-2017.1'
    pluginName 'Circlet Plugin'
    updateSinceUntilBuild false

    publish {
        username 'serjic'
        password 'password'
        channel 'nightly'
    }
}


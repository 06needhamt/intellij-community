fragment commentInfo on Comment {
    ...nodeInfo
    author {
        ...actorInfo
    }
    bodyHTML
    createdAt
}

fragment issueCommentInfo on IssueComment {
    ...commentInfo
    url
}

fragment commitHash on Commit {
    ...nodeInfo
    oid
    abbreviatedOid
}

fragment commitInfo on Commit {
    ...commitHash
    url
    author {
        name
        email
        avatarUrl
        date
        user {
            url
        }
    }
    messageHeadlineHTML
    messageBodyHTML
}

fragment prCommitInfo on PullRequestCommit {
    ...nodeInfo
    commit {
        ...commitInfo
    }
    url
}

fragment prReviewerInfo on RequestedReviewer {
    __typename
    ... on User {
        ...userInfo
    }
}

fragment prReview on PullRequestReview {
    ...nodeInfo
    url
    author {
        ...actorInfo
    }
    bodyHTML
    state
    comments(first: 100) {
        nodes {
            ...prReviewCommentInfo
        }
    }
    createdAt
}

fragment reviewDismissedEvent on ReviewDismissedEvent {
    actor {
        ...actorInfo
    }
    createdAt
    dismissalMessageHTML
    review {
        author {
            ...actorInfo
        }
    }
}

fragment prReviewCommentInfo on PullRequestReviewComment {
    __typename
    ...commentInfo
    url
    path
    commit {
        ...commitHash
    }
    position
    originalCommit {
        ...commitHash
    }
    originalPosition
    replyTo {
        ...nodeInfo
    }
}

fragment renamedEvent on RenamedTitleEvent {
    actor {
        ...actorInfo
    }
    previousTitle
    currentTitle
    createdAt
}

fragment closedEvent on ClosedEvent {
    actor {
        ...actorInfo
    }
    createdAt
}

fragment reopenedEvent on ReopenedEvent {
    actor {
        ...actorInfo
    }
    createdAt
}

fragment mergedEvent on MergedEvent {
    actor {
        ...actorInfo
    }
    createdAt
}

fragment assignedEvent on AssignedEvent {
    actor {
        ...actorInfo
    }
    createdAt
    user {
        ...userInfo
    }
}

fragment unassignedEvent on UnassignedEvent {
    actor {
        ...actorInfo
    }
    createdAt
    user {
        ...userInfo
    }
}

fragment labeledEvent on LabeledEvent {
    actor {
        ...actorInfo
    }
    createdAt
    label {
        ...labelInfo
    }
}

fragment unlabeledEvent on UnlabeledEvent {
    actor {
        ...actorInfo
    }
    createdAt
    label {
        ...labelInfo
    }
}

fragment reviewRequestedEvent on ReviewRequestedEvent {
    actor {
        ...actorInfo
    }
    createdAt
    requestedReviewer {
        ...prReviewerInfo
    }
}

fragment reviewRequestRemovedEvent on ReviewRequestRemovedEvent {
    actor {
        ...actorInfo
    }
    createdAt
    requestedReviewer {
        ...prReviewerInfo
    }
}

fragment gitRefName on Ref {
    name
}

fragment baseRefForcePushedEvent on BaseRefForcePushedEvent {
    actor {
        ...actorInfo
    }
    createdAt
    ref {
        ...gitRefName
    }
    beforeCommit {
        ...commitHash
    }
    afterCommit {
        ...commitHash
    }
}

fragment headRefForcePushedEvent on HeadRefForcePushedEvent {
    actor {
        ...actorInfo
    }
    createdAt
    ref {
        ...gitRefName
    }
    beforeCommit {
        ...commitHash
    }
    afterCommit {
        ...commitHash
    }
}

fragment headRefDeletedEvent on HeadRefDeletedEvent {
    actor {
        ...actorInfo
    }
    createdAt
    headRefName
}

fragment headRefRestoredEvent on HeadRefRestoredEvent {
    actor {
        ...actorInfo
    }
    createdAt
}

fragment baseRefChangedEvent on BaseRefChangedEvent {
    actor {
        ...actorInfo
    }
    createdAt
}

query($repoOwner: String!, $repoName: String!, $number: Int!, $pageSize: Int = 100, $cursor: String) {
    repository(owner: $repoOwner, name: $repoName) {
        pullRequest(number: $number) {
            timelineItems(first: $pageSize, after: $cursor) {
                pageInfo {
                    startCursor
                    hasPreviousPage
                    endCursor
                    hasNextPage
                }
                nodes {
                    __typename
                    ...prCommitInfo
                    ...prReview
                    ...issueCommentInfo

                    ...renamedEvent

                    ...closedEvent
                    ...reopenedEvent
                    ...mergedEvent

                    ...assignedEvent
                    ...unassignedEvent

                    ...labeledEvent
                    ...unlabeledEvent

                    ...reviewRequestedEvent
                    ...reviewRequestRemovedEvent

                    ...reviewDismissedEvent

                    ...baseRefChangedEvent
                    ...baseRefForcePushedEvent

                    ...headRefForcePushedEvent
                    ...headRefDeletedEvent
                    ...headRefRestoredEvent
                }
            }
        }
    }
}